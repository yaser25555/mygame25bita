<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; connect-src 'self' https://mygame25bita-7eqw.onrender.com https://mygame25bita-1-4ue6.onrender.com wss: ws:; style-src 'self' 'unsafe-inline'; img-src 'self' data:;">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Voice Boom">
    <meta name="theme-color" content="#002A1B">
    <meta name="msapplication-TileColor" content="#002A1B">
    <meta name="msapplication-navbutton-color" content="#002A1B">
    <title>ุงูุจุฑููุงูู - INFINITY BOX VOICEBOOM</title>
    <link rel="stylesheet" href="profile-styles.css">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="logo.png">
</head>
<body>
    <div class="container">
        <!-- ุดุฑูุท ุงูุชููู -->
        <nav class="navbar">
            <div class="nav-left">
                <button class="nav-btn" data-action="goBack">โ ุฑุฌูุน</button>
            </div>
            <div class="nav-center">
                <h1>ุงูููู ุงูุดุฎุตู</h1>
            </div>
            <div class="nav-right">
                <button class="nav-btn" data-action="editProfile">โ๏ธ</button>
            </div>
        </nav>

        <!-- ูุนูููุงุช ุงูุจุฑููุงูู ุงูุฃุณุงุณูุฉ -->
        <div class="profile-header">
            <div class="profile-avatar">
                <img id="user-avatar" src="images/default-avatar.png" alt="ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ">
                <button class="edit-avatar-btn" data-action="editAvatar">๐ท</button>
            </div>
            <div class="profile-info">
                <h2 id="display-name">ุงุณู ุงููุณุชุฎุฏู</h2>
                <div class="user-id" id="user-id">ID: -</div>
                <div class="user-level">ุงููุณุชูู: <span id="user-level">1</span></div>
            </div>
        </div>

        <!-- ุญุงูุฉ ุงูุฏุฑุน -->
        <div class="shield-status inactive" id="shield-status">
            <div class="shield-icon">๐ก๏ธ</div>
            <div class="shield-info">
                <div class="shield-duration" id="shield-duration">-</div>
            </div>
        </div>

        <!-- ุญุงููุฉ ุงููุนูููุงุช ุงูุดุงููุฉ -->
        <div class="info-container">
            <!-- ุงูุฅูุฌุงุฒุงุช -->
            <div class="achievements-section">
                <h3>๐ ุงูุฅูุฌุงุฒุงุช</h3>
                <div class="achievements-grid" id="achievements-grid">
                    <div class="achievement-placeholder">ูุง ุชูุฌุฏ ุฅูุฌุงุฒุงุช ุจุนุฏ</div>
                </div>
            </div>

            <!-- ุงูุฃุตุฏูุงุก -->
            <div class="friends-section">
                <h3>๐ฅ ุงูุฃุตุฏูุงุก</h3>
                <div class="friends-grid" id="friends-grid">
                    <div class="friends-placeholder">ูุง ุชูุฌุฏ ุฃุตุฏูุงุก ุจุนุฏ</div>
                </div>
            </div>
        </div>

        <!-- ุฃุฒุฑุงุฑ ุงูุฅุฌุฑุงุกุงุช -->
        <div class="action-buttons">
            <button class="btn primary" data-action="playGame">๐ฎ ุงูุนุจ ุงูุขู</button>
            <button class="btn secondary" data-action="privateChat">๐ฌ ุงููุญุงุฏุซุฉ ุงูุฎุงุตุฉ</button>
            <button class="btn secondary" data-action="viewStats">๐ ุงูุฅุญุตุงุฆูุงุช</button>
        </div>
    </div>

    <!-- Modal ูุชุนุฏูู ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ -->
    <div id="avatarModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeAvatarModal()">&times;</span>
            <h3>ุชุบููุฑ ุงูุตูุฑุฉ ุงูุดุฎุตูุฉ</h3>
            <form id="avatarForm" onsubmit="updateAvatar(event)">
                <div class="form-group">
                    <label for="avatarFile">ุงุฎุชุฑ ุตูุฑุฉ:</label>
                    <input type="file" id="avatarFile" accept="image/*" onchange="previewAvatar(event)" required>
                </div>
                <div class="avatar-crop-container">
                    <div class="crop-area">
                        <img id="avatarPreview" src="" alt="ูุนุงููุฉ" style="display: none;">
                        <div class="crop-overlay" id="cropOverlay" style="display: none;">
                            <div class="crop-frame" id="cropFrame"></div>
                        </div>
                    </div>
                    <div class="crop-controls" id="cropControls" style="display: none;">
                        <button type="button" onclick="adjustCrop('zoom-in')" class="btn secondary">๐+ ุชูุจูุฑ</button>
                        <button type="button" onclick="adjustCrop('zoom-out')" class="btn secondary">๐- ุชุตุบูุฑ</button>
                        <button type="button" onclick="resetCrop()" class="btn secondary">๐ ุฅุนุงุฏุฉ ุชุนููู</button>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn primary">๐พ ุญูุธ</button>
                    <button type="button" onclick="closeAvatarModal()" class="btn secondary">โ ุฅูุบุงุก</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal ูุชุนุฏูู ุงูุจุฑููุงูู -->
    <div id="profileModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeProfileModal()">&times;</span>
            <h3>ุชุนุฏูู ุงูุจุฑููุงูู</h3>
            <form id="profileForm" onsubmit="updateProfile(event)">
                <div class="form-group">
                    <label for="displayName">ุงูุงุณู ุงููุนุฑูุถ:</label>
                    <input type="text" id="displayNameInput" required>
                </div>
                <div class="form-group">
                    <label for="genderSelect">ุงูุฌูุณ:</label>
                    <select id="genderSelect">
                        <option value="prefer-not-to-say">ุฃูุถู ุนุฏู ุงูุฅูุตุงุญ</option>
                        <option value="male">ุฐูุฑ</option>
                        <option value="female">ุฃูุซู</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn primary">๐พ ุญูุธ</button>
                    <button type="button" onclick="closeProfileModal()" class="btn secondary">โ ุฅูุบุงุก</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุงููุญุงุฏุซุฉ ุงูุฎุงุตุฉ -->
    <div id="privateChatModal" class="modal">
        <div class="modal-content" style="max-width: 350px;">
            <span class="close" onclick="closePrivateChat()">&times;</span>
            <h3 id="privateChatTitle">ูุญุงุฏุซุฉ ุฎุงุตุฉ</h3>
            <div id="privateChatMessages" class="private-chat-messages"></div>
            <form id="privateChatForm" onsubmit="sendPrivateMessage(event)">
                <input type="text" id="privateChatInput" placeholder="ุงูุชุจ ุฑุณุงูุชู..." autocomplete="off" required style="width: 100%; margin-top: 10px; padding: 8px; border-radius: 8px; border: 1px solid #ccc;">
                <button type="submit" class="btn primary" style="width: 100%; margin-top: 8px;">ุฅุฑุณุงู</button>
            </form>
        </div>
    </div>

    <!-- ูุงุฌูุฉ ุงููุญุงุฏุซุฉ ุงูุฎุงุตุฉ ุงูุญุฏูุซุฉ -->
    <div class="chat-container" id="chatContainer">
        <div class="chat-sidebar" id="chatSidebar">
            <div class="chat-sidebar-header">
                <span>ุงููุญุงุฏุซุงุช ุงูุฎุงุตุฉ</span>
            </div>
            <div class="chat-list" id="chatList">
                <!-- ูุงุฆูุฉ ุงููุญุงุฏุซุงุช ุชุธูุฑ ููุง -->
            </div>
        </div>
        <div class="chat-main" id="chatMain">
            <div class="chat-header" id="chatHeader">
                <span id="chatWithName">ุงุฎุชุฑ ุตุฏููุงู ูุจุฏุก ุงููุญุงุฏุซุฉ</span>
                <span class="chat-status" id="chatStatus"></span>
            </div>
            <div class="chat-messages" id="chatMessages">
                <!-- ุงูุฑุณุงุฆู ุชุธูุฑ ููุง -->
            </div>
            <form class="chat-input-form" id="chatInputForm" style="display: none;">
                <input type="text" id="chatInput" placeholder="ุงูุชุจ ุฑุณุงูุชู..." autocomplete="off" required />
                <button type="submit" class="btn primary">ุฅุฑุณุงู</button>
            </form>
        </div>
    </div>

    <script>
        // ุชุณุฌูู Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        console.log('โ Service Worker ูุณุฌู ุจูุฌุงุญ:', registration.scope);
                    })
                    .catch((error) => {
                        console.log('โ ูุดู ูู ุชุณุฌูู Service Worker:', error);
                    });
            });
        }
    </script>
    <script src="https://cdn.socket.io/4.7.4/socket.io.min.js"></script>
    <script src="profile.js"></script>
</body>
</html> 