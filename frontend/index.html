<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>INFINITY BOX VOICEBOOM</title>
    <link href="https://fonts.googleapis.com/css2?family=Amiri&family=Scheherazade+New:wght@400;700&family=Noto+Naskh+Arabic:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="login-styles.css">
    <script>
        // ุงูุชุญูู ูู token ุนูุฏ ุชุญููู ุงูุตูุญุฉ
        (async function() {
            const token = localStorage.getItem('token');
            const isAdmin = localStorage.getItem('isAdmin') === 'true';
            
            console.log('๐ ูุญุต token ูู index.html:', token ? 'ููุฌูุฏ' : 'ุบูุฑ ููุฌูุฏ');
            console.log('๐ค ููุน ุงููุณุชุฎุฏู:', isAdmin ? 'ูุดุฑู' : 'ูุงุนุจ ุนุงุฏู');
            
            if (token) {
                // ุชุญูู ูู ุตูุงุญูุฉ ุงูุชููู ุนุจุฑ API
                try {
                    const res = await fetch('https://mygame25bita-7eqw.onrender.com/api/users/me', {
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    if (res.ok) {
                        const data = await res.json();
                        if (isAdmin) {
                            // ูููุดุฑูููุ ุฅุธูุงุฑ ุฎูุงุฑ ุงูุฏุฎูู ููุนุจุฉ ุฃู ููุญุฉ ุงูุชุญูู
                            console.log('๐ฏ ุฅุธูุงุฑ ุฎูุงุฑุงุช ุงููุดุฑู');
                        } else {
                            window.location.href = 'game.html';
                        }
                    } else {
                        // Token ุบูุฑ ุตุงูุญุ ุญุฐู ูุฅุจูุงุก ุงููุณุชุฎุฏู ูู ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
                        localStorage.removeItem('token');
                        localStorage.removeItem('username');
                        localStorage.removeItem('isAdmin');
                    }
                } catch (e) {
                    // ูู ุญุงู ูุดู ุงูุงุชุตุงูุ ุฅุจูุงุก ุงููุณุชุฎุฏู ูู ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
                }
            } else {
                console.log('โ ุงููุณุชุฎุฏู ุบูุฑ ูุณุฌู ุฏุฎููุ ุงูุจูุงุก ูู ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู');
            }
        })();
    </script>
</head>
<body>
    <div class="container">
        <img src="images/logo.png" alt="Voice Boom Logo" class="logo">
        <h1>INFINITY BOX VOICEBOOM</h1>

        <!-- ูููุฐุฌ ุฑูุน ุตูุฑุฉ ุงูููู ุงูุดุฎุตู -->
        <div id="avatar-section" style="display:none; text-align:center; margin-bottom:20px;">
            <form id="avatarForm">
                <input type="file" id="avatarInput" name="avatar" accept="image/*" style="margin-bottom:10px;" />
                <button type="submit">ุฑูุน ุงูุตูุฑุฉ</button>
            </form>
            <img id="profileAvatar" src="images/logo.png" alt="Avatar" style="width:100px;height:100px;border-radius:50%;display:block;margin:10px auto;" />
        </div>

        <div id="admin-choice-modal" class="modal-overlay hidden">
            <div class="modal-content">
                <h3>ุฃููุงู ุจู ุฃููุง ุงููุดุฑู</h3>
                <p>ุฅูู ุฃูู ุชุฑูุฏ ุงูุฐูุงุจุ</p>
                <button id="go-to-game-btn" class="btn">ุงูุฏุฎูู ููุนุจุฉ</button>
                <button id="go-to-admin-btn" class="btn">ุงูุฏุฎูู ูููุญุฉ ุงูุชุญูู</button>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-button active" id="login-tab">ุชุณุฌูู ุงูุฏุฎูู</button>
            <button class="tab-button" id="register-tab">ุชุณุฌูู</button>
            <button class="tab-button" id="contact-tab">ููุงุณุชูุณุงุฑ ูุดุญู ุงูุนููุงุช</button>
        </div>

        <div id="message-box" class="message-box"></div>

        <!-- ูุณู ุชุณุฌูู ุงูุฏุฎูู -->
        <div id="login-section" class="content-section active">
            <form id="login-form" method="POST" action="javascript:void(0)" autocomplete="on">
                <div class="form-group">
                    <label for="login-username">ุงุณู ุงููุณุชุฎุฏู / ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</label>
                    <input type="text" id="login-username" placeholder="ุฃุฏุฎู ุงุณู ุงููุณุชุฎุฏู ุฃู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู" required>
                </div>
                <div class="form-group">
                    <label for="login-password">ูููุฉ ุงููุฑูุฑ:</label>
                    <input type="password" id="login-password" placeholder="ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ" required>
                </div>
                <button id="login-button" class="btn" type="submit">
                    <span class="loading-spinner"></span>
                    <span class="btn-text">ุชุณุฌูู ุงูุฏุฎูู</span>
                </button>
            </form>
        </div>

        <!-- ูุณู ุงูุชุณุฌูู -->
        <div id="register-section" class="content-section">
            <form id="register-form" method="POST" action="javascript:void(0)" autocomplete="on">
                <div class="form-group">
                    <label for="register-username">ุงุณู ุงููุณุชุฎุฏู:</label>
                    <input type="text" id="register-username" placeholder="ุงุฎุชุฑ ุงุณู ูุณุชุฎุฏู" required>
                </div>
                <div class="form-group">
                    <label for="register-email">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</label>
                    <input type="email" id="register-email" placeholder="ุฃุฏุฎู ุจุฑูุฏู ุงูุฅููุชุฑููู" required>
                </div>
                <div class="form-group">
                    <label for="register-password">ูููุฉ ุงููุฑูุฑ:</label>
                    <input type="password" id="register-password" placeholder="ุงุฎุชุฑ ูููุฉ ูุฑูุฑ" required>
                </div>
                <button id="register-button" class="btn" type="submit">
                    <span class="loading-spinner"></span>
                    <span class="btn-text">ุชุณุฌูู</span>
                </button>
            </form>
        </div>

        <!-- ูุณู ูุญุชูู ุงูุชุทุจููุงุช (ูุธูุฑ ุนูุฏ ุงูููุฑ ุนูู ุชุจููุจ ุงูุชุทุจููุงุช) -->
        <!-- ุชู ุฅุฒุงูุฉ ูุฐุง ุงููุณู ุจุงููุงูู -->

        <!-- ูุณู ูุญุชูู ุงูุชูุงุตู ูุนูุง (ูุธูุฑ ุนูุฏ ุงูููุฑ ุนูู ุชุจููุจ ุงูุชูุงุตู) -->
        <div id="contact-section-content" class="content-section">
            <h3>ููุงุณุชูุณุงุฑ ูุดุญู ุงูุนููุงุช</h3>
            <p>ูุณุนุฏูุง ุชููู ุงุณุชูุณุงุฑุงุชูู ููุณุงุนุฏุชูู ูู ุดุญู ุงูุนููุงุช. ูุง ุชุชุฑุฏุฏูุง ูู ุงูุงุชุตุงู ุจูุง.</p>
            <div class="contact-info-item">
                <i class="fas fa-envelope"></i> ุงูุจุฑูุฏ ุงูุฅููุชุฑููู: <a href="mailto:YASER.HAROON79@GMAIL.COM">YASER.HAROON79@GMAIL.COM</a>
            </div>
            <div class="contact-info-item">
                <i class="fab fa-whatsapp"></i> ุฑูู ูุงุชุณุงุจ: <a href="https://wa.me/966554593007">00966554593007</a>
            </div>
        </div>
    </div>

    <script src="login.js"></script>
</body>
</html>